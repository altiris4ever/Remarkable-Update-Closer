# Remarkable Update Closer

A PowerShell script to suppress the faulty update dialog generated by the Remarkable application, which is built on the [WinSparkle](https://winsparkle.org) framework.

---

## Overview

The Remarkable application's use of the WinSparkle updater presents challenges in suppressing its "Software Update" dialog. While the framework itself supports functionality such as skipping or postponing updates, the implementation in Remarkable appears intrusive. This script automatically closes the update dialog whenever it appears.

---

## Features

### Core Functionality
- Identifies and closes dialog windows with specific titles (`PartialTitle`) generated by a target process (`ProcessName`).
- Utilizes Windows API (`User32.dll`) to enumerate and manipulate windows.

### Script Variants

#### Remarkable-Update-Closer.ps1
- **Purpose**: Basic version for identifying and closing the update dialog.
- **Functionality**:
  - Enumerates all open windows.
  - Matches the window title and process name.
  - Sends a `WM_CLOSE` message to close the dialog.

#### Remarkable-Update-Closer.concept.ps1
- **Purpose**: Enhanced version with optimizations and additional features.
- **Enhancements**:
  - **CPU Optimization**: Gradually increases wait time when no matching windows are found.
  - **Process-Aware Monitoring**: Checks if the target process is running before enumerating windows.
  - **Logging**: Creates logs for debugging and tracking script behavior.
  - **Error Handling**: Robust handling of exceptions with `try-catch-finally` blocks.

---

## Installation

### Prerequisites
- **PowerShell**: Ensure PowerShell is installed and accessible.
- **PS2EXE**: For compiling the script into an `.exe` file (optional). See the **Compiling to .EXE** section for more details.

---

## Compiling to .EXE

Both scripts can be compiled into `.exe` format for easy and silent running. 

### How to Create a Compiled .exe from PowerShell
You can use tools like **PS2EXE** to compile a PowerShell script into a `.exe` file.

#### Steps to Compile

1. **Install PS2EXE**:
   - Open PowerShell as Administrator.
   - Run the following command:
     ```powershell
     Install-Module -Name PS2EXE -Scope CurrentUser
     ```

2. **Compile the Script**:
   - Assuming your script is named `Remarkable-Update-Closer.ps1`, run the following command:
     ```powershell
     Invoke-PS2EXE -InputFile "Remarkable-Update-Closer.ps1" -OutputFile "Remarkable-Update-Closer.exe"
     ```

3. **Optional: Hide the Console Window and Add an Icon**:
   - To compile without displaying a console window and include a custom icon:
     ```powershell
     Invoke-PS2EXE .\Remarkable-Update-Closer.ps1 -NoConsole -IconFile "C:\Temp\Icon.ico"
     ```

4. **Run the Compiled .EXE**:
   - The resulting `.exe` file will run directly without requiring the PowerShell interpreter.

   - If compiled with the `-NoConsole` option, the script will run silently without any console window appearing.

---

## How to Use

1. Clone or download the repository:
   ```bash
   git clone https://github.com/your-repo/remarkable-update-closer.git

# Possible usage, start the script from a scheduled task when application is installed, or even better, create your own script that start remarkable.exe and my script, and compile that ps1 scrript into an .exe file and change the shortcut to that .exe file.
Change the remarable shortcut so it starts the new program.
Or create an Appv package like I did that uses a startupsript from in user context on startProcess, this way the script will always run when remarkable.exe is started even if they go to the directory where it's installed and starts the .exe manually from there.
